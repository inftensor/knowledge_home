# 1 计算机系统简介
## 1.1 计算机的软硬件概念
计算机系统由"硬件"和软件两大部分组成
- 硬件：是指计算机的实体部分，它由看得见摸得着的各种电子器件，各类光、电、机设备的实物组成
- 软件：由人们事先编制的具有各类特殊功能的程序组成。
  计算机软件又可以分为两大类：
    - 系统软件：又叫系统程序，主要用来管理整个计算机系统，监视服务，使得系统资源得到合理调度，高效运行，它包括：
        1. 标准程序库
        2. 语言处理程序
        3. 操作系统
        4. 服务程序
        5. 数据库管理系统
        6. 网络软件
    - 应用软件：又称应用程序，是用户根据任务需要所编制的各种程序。

## 1.2 计算机的层次结构
现在的计算机的解题过程如下：
<img src="./image/ch01_00_00.svg" style="display:block; margin:0 auto;">
以下按照计算机的发展历程展示计算机的层次结构

1. 早期的计算机只有机器语言(用0,1所表示的语言),用户必须用二级制代码来编写程序。
    <img src="./image/ch01_00_01.svg" style="display:block; margin:0 auto;">
2. 20世纪50年代开始出现了符号式的程序设计语言，即汇编语言。它使用ADD、SUB、MUL、DIV等分别表示加减乘除等操作，并用符号表示指令或数据所在存储单元的地址。
    必须先将汇编语言程序翻译成机器语言程序，然后才能被机器接受并自动运行。
    <img src="./image/ch01_00_02.svg" style="display:block; margin:0 auto;">
3. 20世纪60年代出现了各种面向问题的高级语言，如FORTRAN、BASIC、PASCAL、C等。
    先将高级语言翻译成汇编语言(或其他中间语言程序)，然后再翻译成机器语言程序；或者将高级语言直接翻译成机器语言程序。
    将高级语言翻译成机器语言程序的软件称为==翻译程序==，翻译程序分两种
    - 编译程序： 将高级语言程序的全部语句一次性翻译成机器语言，然后再执行机器语言程序
    
    - 解释程序： 将源程序的一条语句翻译成对应于机器语言的一条语句，并立即执行这条语句，接着翻译、执行，直到完成全部的源程序。
    
	其图如下：
     <img src="./image/ch01_00_03.svg" style="display:block; margin:0 auto;">
4. 机器$M_1$内部向下延伸而形成下一级的微程序机器$M_0$,机器$M_0$是直接将机器$M_1$的每条指令翻译成一组微指令，即构成一个微程序。
    <img src="./image/ch01_00_04.svg" style="display:block; margin:0 auto;">
5. 对于上述的结构中，在实际机器$M_1$与虚拟机器$M_2$之间还有一级虚拟机器，它是由操作系统软件构成的。
    <img src="./image/ch01_00_05.svg" style="display:block; margin:0 auto;">

## 1.3 计算机组成和计算机体系结构
1. 计算机体系结构是指那些能够被程序员所见到的计算机属性，即概念性的结构与功能特性。计算机系统的属性通常指用机器语言编程的程序员所看到的传统机器的属性，包括指令集、数据结构、存储器寻址级数、I/O机等；站在不同层次上编程的程序员所看到的计算机属性也不相同
2. 计算机组成是指如何实现计算机体系结构所体现的属性，包含许多对程序员来说是透明的硬件细节。

例如：指令系统体现了机器的属性，属于计算机结构的问题;但指令的实现，即如何取指令、分析指令、取操作数、运算、送结果等都属于是计算机组成问题。

# 2. 计算机的基本组成

## 2.1 冯·诺依曼计算机的特点

冯·诺依曼计算机特点如下：
1. 计算机由运算器、存储器、控制器、输入设备和输出设备五大部件组成
2. 指令和数据以同等地位存放于存储器内，并可按地址寻址
3. 指令和数据均用二进制数表示
4. 指令由操作码和地址码组成，操作码用来表示操作的性质，地址码用来表示操作数在存储器中的位置
5. 机器以==运算器==为中心，输入输出设备与存储器间的数据传送通过运算器完成。

<img src="./image/ch01_01_00.svg" style="display:block; margin:0 auto;">

## 2.2 计算机的硬件图

现代的计算机已经转化为以==存储器==为中心，各部件的功能如下：
- 运算器用来完成算术运算和逻辑运算，并将运算的中间结果暂存在运算器内
- 存储器用来存放数据和程序
- 控制器用来控制、指挥程序和数据的输入、运行以及处理运算结果
- 输入设备来控制、指挥程序和数据的输入、运行以及处理运算结果
- 输出设备可将人类熟悉的信息形式转换为机器能识别的信息形式

<img src="./image/ch01_01_01.svg" style="display:block; margin:0 auto;">



在大规模集成电路制作工艺出现后，将运算器和控制器结合起来统称为中央处理器(CPU)，把输入设备与输出设备统称为I/O设备。这样，现代计算机由以下三部分组成：

1. CPU
2. I/O设备
3. 主存储器(MM)
   

而CPU与主存储器联合起来又可以称为主机，I/O设备又可以称为外部设备。

<img src="./image/ch01_01_02.svg" style="display:block; margin:0 auto;">
上图中，主存储器是存储器子系统中的一类，用来存放程序和数据，可以直接与CPU交换信息。另一类是辅助存储器，简称辅存，又称外存。
算术逻辑单元(ALU)简称算逻部件，用来完成算术逻辑运算。控制单元(CU)用来解释存储器中的命令，并发出各种操作命令来执行命令。

## 2.3 计算机的工作步骤

1. 上机前准备
    - 建立数学模型
    - 确定计算方法
    - 编制解题程序
2. 计算机的工作过程
   先分析计算机组成框图
    <img src="./image/ch01_01_03.svg" style="display:block; margin:0 auto;">
   
   - 主存储器
	 主存储器(简称==主存==或==内存==)包括存储体、各种逻辑部件及控制电路。
      存储体M：
      
        - 存储体由许多存储单元组成，每个存储单元又包含若干个存储元件(或称存储基元、存储元),每个存储元件能寄存一位二进制代码
        - 一个存储单元可以存储一串二进制代码，称这串二级制代码为一个存储字，这串二进制代码的位数称为存储字长
	     - 主存的工作方式就是按存储单元的地址号来实现对存储字各位的存(写入)、取(读出)。这种存取方式称为按地址存取方式，即按地址访问存储器(简称==访存==)。
	   
      为了实现按地址访问，主存中还配有两个寄存器MAR和MDR。
      MAR:
        - MAR是存储器地址寄存器，用来存放想要访问的存储单元地址，其位数对应存储单元的个数
        - 例如：MAR为10位，则有$2^{10}$=1024个存储单元，记为1K。
      
       MDR:
        - MDR是存储数据寄存器，用来存放从存储体某单元取出来的代码或者准备往某存储单元存入的代码，其位数与存储字长相等。
      
   - 运算器
     运算器至少包含3个寄存器和一个算术逻辑单元(ALU)。其中ACC为累加器，MQ为乘商寄存器，X为操作数寄存器。在进行不同计算时，各寄存器所存放的操作数类别也各不相同。
   
     |      |    加法    |    减法    |      乘法      |     除法     |
     | :--: | :--------: | :--------: | :------------: | :----------: |
     | ACC  | 被加数及和 | 被减数及差 |    乘积高位    | 被除数及余数 |
     |  MQ  |            |            | 乘数及乘积低位 |      商      |
     |  X   |    加数    |    减数    |     被乘数     |     除数     |
     
     以下简要分析各种运算的操作过程：
        - 加法
            [M]$\to$ X
            [ACC]+[X] $\to$ ACC
        - 减法
            [M]$\to$X
            [ACC]-[X]$\to$ACC
        - 乘法
            [M]$\to$MQ
            [ACC]$\to$X
            0$\to$ACC
            [X]$\times$[MQ]$\to$ACC//MQ  (//表示两个寄存器串联)
        - 除法 
            [M]$\to$X
            [ACC] / [X]$\to$MQ
            余数R在ACC中
   - 控制器
    控制器是计算机的神经中枢，由它指挥各部件自动、协调地工作。一条指令的操作一般包含取指、分析、执行3个阶段：
        - 取指：命令存储器读出一条指令
      
        - 分析：对取出的指令进行分析，指出该指令要完成什么样的操作，并按寻址特征指明操作数的地址
      
       - 执行：根据操作数所在的地址以及指令的操作码完成某种操作
	    控制器
      
      控制器由程序计数器(PC)、指令寄存器(IR)以及控制单元(CU)组成。
       - PC:用来存放当前想要执行指令的地址，它与主存的MAR之间有一条直接通路，且具有自动加1的功能，即可自动形成下一条指令的地址
       - IR：用来存放当前的指令，IR的内容来自主存的MDR。
         1. IR中的操作码(OP(IR))送至CU，记作OP(IR)$\to$CU,用来分析指令
         2. 地址码(Ad(IR))作为操作数的地址送至存储器的MAR，记作Ad(IR)$\to$MAR - CU：用来分析当前指令所需完成的操作，并发出各种微操作命令序列，用以控制所有被控制的对象。



# 3. 计算机硬件的主要指标技术
## 3.1 机器字长

是指CPU一次能处理数据的位数，通常与CPU的寄存器位数有关。字长越长，数的表示范围越大，精度也越高。机器字长也会影响及其的运行速度。

## 3.2 存储容量

存储器的容量应该包括存主存容量和辅存容量。
- 主存容量是指主存中存放二进制代码的总位数，即
    $$
    存储容量=存储单元个数\times 存储字长
    $$
- MAR中的位数反映了存储单元的个数，MDR的位数反映了存储字长。
    例如：MAR为16位，MDR为32位，则存储容量为$2^{16}\times 32=2M$位
- 现代计算机通常以字节来描述容量大小，其中一个字节被定义为8位二进制代码。
    例如：上述的$2M$位也可以用$2^{18}$字节表示，记作$2^{18}$B或256KB。


## 3.3 运行速度
1. 普通法：早期用完成一次加法或乘法所需的时间来衡量运算速度
2. 吉普森法：综合考虑每条指令的执行时间以及它们在全部操作中所占的百分比
    $$
    T_M=\sum_{i=1}^nf_it_i
    $$
    其中$T_M$为机器运行速度；$f_i$为第$i$种指令占全部操作的百分比数；$t_i$为第$i$种指令的执行时间。
3. 现在的机器普遍使用单位时间内执行指令的平均条数来衡量，并用MIPS(百万指令每秒)作为计量单位;也可以用CPI即执行一条指令所需的时钟周期(机器主频的倒数)数；或者用FLOPS(浮点运算次数每秒)来衡量运算速度。