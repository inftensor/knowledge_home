# 1. 常微分方程的基本概念
一般的，称含有未知数的导数或微分的方程称为微分方程。未知函数是一元函数的微分方程，称为常微分方程;未知数含有多个自变量的微分方程的微分方程称为偏微分方程。
    如果一组任意常数不能通过运算合并而使得任意常数的个数减少的话，则称这组常量的独立的。对于$n$阶微分方程的解来说，如果它含有任意常数，且其中任意常数个数与方程的阶数相同，则称该解为微分方程的通解

通常的，$n$阶微分方程的一般形式为
$$
\Phi(x,y,C_1,C_,\dots, C_n)=0
$$
其中$C_1,C_2, \dots, C_n$为相互独立的任意常数，若上式可表示为
$$
y=\varphi(x,C_1,C_,\dots, C_n)
$$
则称它为微分方程的显示解，否则称为隐式解或通积分。
以下是关于微分的一些小概念:
1. 确定了通解中任意常数以后所得到的解称为微分方程的特解
2. 用于确定通解中任意常数的条件称为初始条件
3. 求微分方程满足初始条件的解的问题称为初值问题
4. 微分方程的解的曲线称为微分方程的积分曲线，含有任意常数的通解的曲线称为积分曲线族。

# 2. 可分离变量方程
如果一阶微分方程$F(x,y,y')=0$能化成
$$
N(y)dy=M(x)dx
$$
的形式，则称该一阶微分方程为可分离变量方程。
设$G(y)$和$F(x)$分别是$N(y)$和$M(x)$的原函数，则
$$
G(y)=F(x)+C
$$
是方程$N(y)dy=M(x)dx$的解，且是隐式通解。


# 3. 齐次方程
## 3.1 齐次方程的定义
形如
$$
y'=f(\frac{y}{x})
$$
的方程称为齐次方程。
齐次方程$y'=f(\frac{y}{x})$的解法是通过变换$u=\frac{y}{x}$把原方程转换成可分离变量方程。
过程如下：
1. 令$u=\frac{y}{x}$,则$y=ux$,$y'=xu'+u$,方程转化为
    $$
    xu'+u=f(u)
    $$
2. 转化为可分离变量方程
   $$
   xu'=f(u)-u \\
   \frac{du}{f(u)-u}=\frac{1}{x}dx
   $$

## 3.2 $\frac{dy}{dx}=f(\frac{ax+by+c}{a_1x+b_1y+c_1})$型微分方程
以下是对方程$\frac{dy}{dx}=f(\frac{ax+by+c}{a_1x+b_1y+c_1})$的探讨：
1. 当$c=c_1=0$时，$\frac{dy}{dx}=f(\frac{ax+by}{a_1x+b_1y})$=$f(\frac{a+b\cdot \frac{y}{x}}{a_1+b_1\cdot\frac{y}{x} })$是一个其次方程
2. 当$\Delta = \begin{vmatrix} a&b\\ a_1&b_1\end{vmatrix}\neq 0$时
    作变量代换
    $$
    \begin{cases}
    x=X+\alpha \\
    y=Y+\beta
    \end{cases}
    $$
    其中，$\alpha, \beta$为待定方的常数。
    代入原方程并能求出唯一解，则原方程可转为
    $$
    \frac{dY}{dX} = f(\frac{aX+bY}{a_1X+b_1Y})
    $$
    求出该齐次方程的解后，回代即可得到原方程的解
3. 当$b_1=b=0$时，$\frac{dy}{dx}=f(\frac{ax+c}{a_1x+c_1})$ 是可分离变量方程
4. 当$a_1=b_1=0,b\neq0$时，
    做变量代换$u=ax+by$,则$\frac{dy}{dx}=\frac{1}{b}(\frac{du}{dx}-a)$
    原方程可化为
    $$
    \frac{du}{dx}=a+bf(\frac{u+c}{c_1})
    $$
    为可分离变量方程。
5. 当$\frac{a}{a_1}=\frac{b}{b_1}=k(a_1,b_1\neq 0)$时，有
    $$
    a=ka_1,b=kb_1,ax+by=k(a_1x+b_1y)
    $$
    将原方程化为
    $$
    \frac{dy}{dx}=f(\frac{k(a_1x+b_1y)+c}{(a_1x+b_1y)+c_1})
    $$
    再令$u=a_1x+b_1y$,则$y=\frac{1}{b_1}(u-a_1x)$,$\frac{dy}{dx}=\frac{1}{b_1}(\frac{du}{dx}-a_1)$,则
    $$
    \frac{1}{b_1}(\frac{du}{dx}-a_1)=f(\frac{ku+c}{u+c_1})
    $$
    是一个可分离变量方程。


# 4. 一阶线性微分方程
形如
$$
y'+P(x)y=Q(x)
$$
的方程称为一阶线性微分方程，如果$Q(x)\not\equiv0$，则称该方程为一阶线性非齐次方程；如果$Q(x)\equiv0$，则称该方程为一阶线性齐次方程

## 4.1 一阶线性其次方程的解法
一般的，一阶线性齐次方程$y'+P(x)y=0$是一个可分离变量方程，且其通解为
$$
y=Ce^{-\int P(x)dx}
$$

## 4.2 一阶线性非齐次方程
一般采用常数变易法来求一阶线性非齐次方程$y'+P(x)y=Q(x)$的通解，这种方法首先把所对应的齐次方程的通解的常数$C$换成函数$C(x)$，然后代入后求解得到线性非齐次方程的通解为
$$
y=e^{-\int P(x)dx}(\int Q(x)e^{\int P(x)dx}dx+C)
$$
如果把上式改写成
$$
y=Ce^{-\int P(x)dx}+e^{-\int P(x)dx}\int Q(x)e^{\int P(x)dx}dx
$$
由此可以看出:一阶线性非齐次方程的通解等于它对应的线性其次方程的通解与非其次方程自身的一个特解之和。


## 4.3 求解伯努利方程
设整数$n\neq 0,1$,则形如
$$
y'+P(x)y=Q(x)y^n
$$
的方程称为伯努利方程。
对于伯努利方程，一般采取如下方法求取:
1. 将方程$y'+P(x)y=Q(x)y^n$的两端同时除以$y^n$,得到
    $$
    y^{-n}y'+P(x)y^{1-n}=Q(x)
    $$
2. 令$z=y^{1-n}$,则$y^{-n}y'=\frac{1}{1-n}\cdot \frac{dz}{dx}$,于是有
   $$
   \frac{1}{1-n}\cdot \frac{dz}{dx}+P(x)z = Q(x)
   $$
   即：
   $$
   \frac{dz}{dx}+(1-n)P(x)z=(1-n)Q(x)
   $$
   是一个关于$z$的一阶线性非齐次方程，求出通解后回代即可。


# 5. 可降解的高阶微分方程
## 5.1 $y^{(n)}=f(x)$型的微分方程
对于此类方程，求解的方法是逐次积分，逐次将次，其通解为:
$$
y=\int [\dots (\int f(x)dx) \dots ] dx +\tilde{C_1}x^{n-1}+\tilde{C_2}x^{n-2}\dots +\tilde{C_n}
$$
其中$\tilde{C_2}x^{n-2}\dots +\tilde{C_n}$是由$C_1,C_2,\dots ,C_n$整理而得的任意常数。

## 5.2 $F(x,y',y'')=0$型的微分方程
微分方程$F(x,y',y'')=0$的特点是不显示的含有$y$,令$y'=u,y''=u'$,则可以把它化成只含有$u',u$的一阶微分方程
$$
F(x,u,u')=0
$$
假设上述方程的通解为$u=u(x,C_1)$，则原方程的通解为
$$
y=\int u(x,C_1)dx+C_2
$$


## 5.3 $F(y,y',y'')=0$型的微分方程
微分方程$F(y,y',y'')=0$的特点是不显示含有自变量$x$,则令$P=\frac{dy}{dx}$,则$y'=P,y''=P\cdot \frac{dP}{dy}$,代入原式，有
$$
F(y,P,P\frac{dP}{dy})=0
$$
假设上式方程的解为$P=P(y,C_1)$,则原方程的通解为
$$
\int \frac{1}{P(y,C_1)}dy=x+C_2
$$

## 5.4 恰当导数方程
若$F(x,y,y',y'')=0$的左端恰为某一函数$\psi(x,y,y')$对$x$的导数，则可将其化为$\frac{d\psi(x,y,y')}{dx}=0$，具有这种性质的原方程称为恰当导数方程。
若$F(x,y,y',y'')=0$为恰当导数方程，则存在某一函数$\psi(x,y,y')$,使得原方程化为一阶微分方程$\psi(x,y,y')=C_1$,且该方程的通解就是原方程的通解。

# 6. 二阶线性微分方程的一般理论
形如
$$
y''+P(x)y'+Q(x)y=f(x)
$$
的方程称为二阶线性微分方程，若$f(x)\equiv0$,则称该方程为二阶线性齐次方程；若$f(x)\not\equiv 0$,则称该方程为二阶线性非齐次方程

## 6.1 二阶线性齐次方程解的结构
> @Theorem 
> **定理6.1** 若$y_1,y_2$是二阶线性齐次方程$y''+P(x)y'+Q(x)y=0$的解，则$y=C_1y_1+C_2y_2$仍然是它的解，其中$C_1,C_2$为任意常数。

> @Definition
> **定义6.1** 设有函数组$y_1(x),y_2(x),\dots, y_n(x)$,$\forall x\in I$,如果存在一组不全为0的常数$k_1,k_2,\dots, k_n$,使得
> $$
> k_1y_1(x)+k_2y_2(x)+\dots + k_ny_n(x)=0
> $$
> 在区间$I$上恒成立，则称函数组$y_1(x),y_2(x),\dots, y_n(x)$在区间$I$上是线性相关的；
> 如果只有当$k_1=k_2=\dots =k_n=0$时，才能使
> $$
> k_1y_1(x)+k_2y_2(x)+\dots + k_ny_n(x)=0
> $$
> 成立，则称函数组$y_1(x),y_2(x),\dots, y_n(x)$在区间$I$上是线性无关的。


> @Theorem
> **定理6.2**  若$y_1(x)$与$y_2(x)$是二阶线性齐次方程$y''+P(x)y'+Q(x)y=0$的两个线性无关的特解，则$y=C_1(x)y_1(x)+C_2(x)y_2(x)$$(C_1,C_2是任意常数)$是该方程的通解。
> 设$y_1(x)为一个特解，则另一个特解为$
> $$
> y_2(x) = y_1(x)u(x)=y_1(x)\int\frac{1}{y_1^2(x)}e^{-\int P(x) dx} dx
> $$
> 此公式称为刘维尔公式


## 6.2 二阶线性非齐次方程解的结构
> @Theorem
> **定理6.3**   设$y_1$是二阶齐次方程$y''+P(x)y'+Q(x)y=0$的解，$y_2$是其对应的二阶非齐次微分方程$y''+P(x)y'+Q(x)y=f(x)$的解，则$y=y_1+y_2$是$y''+P(x)y'+Q(x)y=f(x)$的解。

> @Theorem
> **定理6.4**   设$y_1,y_2$是方程$y''+P(x)y'+Q(x)y=f(x)$的解，则$y=y_1-y_2$是方程$y''+P(x)y'+Q(x)y=0)$的解。

> @Theorem
> **定理6.5**   设$Y$是二阶齐次方程$y''+P(x)y'+Q(x)y=0$的通解，$y^*$为其对应的二阶非齐次方程$y''+P(x)y'+Q(x)y=f(x)$的一个特解，则$y''+P(x)y'+Q(x)y=f(x)$的通解为$y=Y+y^*$。


> @Theorem
> **定理6.6**   设$y_1^*$和$y_2^*$分别为$y''+P(x)y'+Q(x)y=f_1(x)$和$y''+P(x)y'+Q(x)y=f_2(x)$的特解，则$y^*=y_1^*+y_2^*$是方程$y''+P(x)y'+Q(x)y=f_1(x)+f_2(x)$的特解


> @Theorem
> **定理6.7**   若$y=y_1(x)+iy_2(x)$是方程$y''+P(x)y'+Q(x)y=f_1(x)+if_2(x)$的解，则$y_1(x)与y_2(x)$分别为方程
> $$
> y''+P(x)y'+Q(x)y=f_1(x) \quad 和 y''+P(x)y'+Q(x)y=f_2(x)
> $$
> 的解。

# 7. 二阶常系数线性齐次方程
设$p,q$为实常数，则形如
$$
y''+py'+qy=0
$$
的方程称为二阶常系数线性齐次方程
一般的，代数方程$r^2+pr+q=0$称为微分方程$y''+py'+qy=0$的特征方程，二特征方程的根称为特征根
上述特征方程的根可以用求根公式$r=\frac{-p\pm\sqrt{p^2-4q}}{2}$求出，它们有三种不同的情况：
1. 当$p^2-4q>0$时，特征方程有两个不同的实根$r_1,r_2$,则$y_1=e^{r_1x}$,$y_2=e^{r_2x}$是方程$y''+py'+qy=0$的两个线性无关的特解，故方程$y''+py'+qy=0$的通解为
$$
y_1 = C_1e^{r_1x}+C_2e^{r_2x}
$$
2. 当$p^2-4q=0$时，特征方程有两个相等的实根$r_1=r_2=-\frac{p}{2}$,且$2r+p=0$,此时方程$y''+py'+qy=0$的通解为：
$$
y=(C_1+C_2x)e^{rx}
$$
3. 当$p^2-4q<0$时，特征方程有一对共轭的复根$\alpha \pm \beta i$,方程$y''+py'+qy=0$的通解为
   $$
   \begin{aligned}  y & = C_1e^{\alpha x}\cos \beta x+C_2 e^{\alpha x}\sin \beta x \\ & = (C_1\cos \beta x+C_2\sin \beta x) e^{\alpha x}\end{aligned}
   $$
   
# 8. 二阶常系数线性非齐次方程
设$p,q$为实常数，则形如
$$
y''+py'+qy=f(x)
$$
的方程称为二阶常系数线性非齐次方程,下面介绍几种特殊的二阶常系数线性非齐次方程

## 8.1 $f(x)=P_m(x)e^{\alpha x}$类型
> @Theorem
> **定理8.1**   设$\alpha$是常数，$P_m(x)$是$m$次多项式，则二阶常系数线性非齐次微分方程$y''+py'+qy=P_m(x)e^{\alpha x}$的特解形式为
> $$
> y^* = x^kQ_m(x)e^{\alpha x}
> $$
> 1. 若$\alpha$不是特征方程$r^2+pr+q=0$的根，则$k=0$
> 2. 若$\alpha$是特征方程$r^2+pr+q=0$的单根，则$k=1$
> 3. 若$\alpha$是特征方程$r^2+pr+q=0$的重根，则$k=2$

## 8.2 $f(x)=e^{\alpha x}[P_m(x)\cos \beta x+ P_n(x)\sin \beta x]$类型
> @Theorem
> **定理8.2**   设$\alpha,\beta$是常数,$P_m(x)$是$m$次多项式，$P_n(x)$是$n$次多项式，则二阶常系数线性非齐次微分方程
> $$
> f(x)=e^{\alpha x}[P_m(x)\cos \beta x+ P_n(x)\sin \beta x]
> $$
> 的特解形式为
> $$
> y^* = x^ke^{\alpha x}[r_s^{(1)}(x)\cos \beta x+r_s^{(2)}(x)\sin \beta x]
> $$
> 其中，$s=max\{m, n\}$,$r_s^{(1)}$与$r_s^{(2)}$都是$s$次多项式
> - 若$\alpha \pm i\beta$不是特征方程$r^2+rp+q=0$的根，则$k=0$ 
> - 若$\alpha \pm i\beta$是特征方程$r^2+rp+q=0$的根，则$k=1$ 

## 8.3 欧拉方程
设$p_1,p_2,\dots,p_n$为常数，则形如
$$
x^ny^{(n)}+p_1x^{n-1}y^{(n-1)}+p_2x^{n-2}y^{(n-2)}+\dots+p_{n-1}xy'+p_ny=f(x)
$$
的方程称为欧拉方程
欧拉方程通过变量代换$x=e^t$将其转化成常系数线性微分方程，以下是详细解法
1. 设$x=e^t$或$t=\ln x$,则
    $$
    \begin{aligned}
    \frac{dy}{dx} & = \frac{dy}{dt} \cdot \frac{dt}{dx} = \frac{1}{x} \frac{dy}{dt} \\
    \frac{d^2y}{dx^2} &= \frac{d}{dx}(\frac{dy}{dx})  = \frac{d}{dx}(\frac{1}{x}\frac{dy}{dt})=\frac{1}{x^2}(\frac{d^2y}{dt^2}-\frac{dy}{dt}) \\
    \frac{d^3y}{dx^3} &=\frac{d}{dx}(\frac{d^2y}{dx^2})=\frac{d}{dx}(\frac{1}{x^2}(\frac{d^2y}{dt^2}-\frac{dy}{dt}))=\frac{1}{x^3}(\frac{d^3y}{dt^3}-3\frac{d^2t}{dt^2}+2\frac{dy}{dt})
    \end{aligned}
    $$
2. 若用$D$表示对$t$的求导运算$\frac{d}{dt}$($D$称为微分算子),则
   $$
   \begin{aligned} 
   xy' &= \frac{dy}{dx} = Dy \\ 
   x^2y'' &= \frac{d^2y}{dt^2}-\frac{dy}{dt} = D^2y-Dy=D(D-1)y \\
   x^3y''' &= (D^3-3D^2+2D)y=D(D-1)(D-2)y
   \end{aligned}
   $$ 
   一般的,有:
   $$
   x^ky^{(k)} = D(D-1)(D-2)\dots(D-k+1)y
   $$
3. 微分子按多项式计算，然后代数欧拉方程得以$t$为自变量的常系数线性微分方程，求出解后回代即可求出原方程的解。